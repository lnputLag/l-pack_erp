<UserControl 
    x:Class="Client.Interfaces.Production.ProductionTaskAuto"
    xmlns:local="clr-namespace:Client.Interfaces.Production"
             
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    
    xmlns:common="clr-namespace:Client.Common"    
    xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
    xmlns:controls="clr-namespace:Client.Interfaces.Main"             
    xmlns:lib="clr-namespace:Client.Common"


    mc:Ignorable="d" 
    d:DesignWidth="1900" d:DesignHeight="800" 
    Style="{DynamicResource UserControlCanvas}"  
>

    <UserControl.Resources>
        <ResourceDictionary>

            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/l-pack_erp;component/Assets/Styles/Common.xaml" />
            </ResourceDictionary.MergedDictionaries>

        </ResourceDictionary>
    </UserControl.Resources>

    <Border Style="{DynamicResource DataGridContainerHolder}"  >
        <Grid Style="{DynamicResource DataGridContainer}">

            <Grid.ColumnDefinitions>
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="6*"></RowDefinition>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition Height="3*"></RowDefinition>
                <RowDefinition Height="6*"></RowDefinition>
            </Grid.RowDefinitions>

            <Grid Grid.Row="0"  Grid.Column="0" Grid.ColumnSpan="3" Style="{DynamicResource GridControlPanel}" Panel.ZIndex="8">
                <Border >
                    <Grid >

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="11.5*"/>
                            <ColumnDefinition Width="0.5*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"></RowDefinition>
                        </Grid.RowDefinitions>


                        <Grid Grid.Row="0" Grid.Column="0" Name="PositionGridToolbar">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"></RowDefinition>
                                <RowDefinition Height="Auto"></RowDefinition>
                            </Grid.RowDefinitions>

                            <StackPanel Grid.Row="0" Grid.Column="0" Style="{DynamicResource FormHeaderButtonsPanel}" HorizontalAlignment="Left"  >
                                <Label Content="C:"  Style="{DynamicResource TopLabel}" Width="25" />
                                <Grid Style="{DynamicResource FormFieldDateHolder}">
                                    <!--<TextBox Name="FromDate"  MaxLength="10"   Style="{DynamicResource FormFieldDate}" IsReadOnly="True" />
                                    <DatePicker SelectedDate="{Binding Path=Text, Mode=OneWayToSource, ElementName=FromDate, Converter={StaticResource DateDate} }" Style="{DynamicResource FormFieldDP}"  />-->
                                    <controls:DatePicker x:Name="FromDate" Style="{DynamicResource DateEditStyle}" >
                                    </controls:DatePicker>
                                </Grid>

                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                <Label Content="Обрезь, %:"  Style="{DynamicResource TopLabel}"/>
                                <CheckBox x:Name="Trim10"  Content="10%" Style="{DynamicResource CheckBoxTopPanel}"  />
                                <xctk:DecimalUpDown x:Name="Trim" Grid.Row="0" Grid.Column="2" Width="45" Maximum="100" Minimum="0" Increment=".1" FormatString="F1"  Margin="0,0,5,0" />

                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>
                                <Label Content="Завод:"  Style="{DynamicResource TopLabel}"/>
                                <controls:SelectBox x:Name="Factory" Style="{DynamicResource CustomFormField}" ListBoxMinWidth="150" Width="125" Autocomplete="False" SelectedItemChanged="Factory_SelectedItemChanged"  />

                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                <Label Content="Формат:"  Style="{DynamicResource TopLabel}"/>

                                <StackPanel Orientation="Horizontal" Name="FormatContainer">

                                </StackPanel>

                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                <Label Content="Мин. длина ПЗ"  Style="{DynamicResource TopLabel}"/>
                                <xctk:IntegerUpDown x:Name="TaskMinLength" Increment="100" MinWidth="50" />

                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                <Button Name="ShowButton"    Content="Показать"    Style="{DynamicResource Button}"  Click="ShowButton_Click"  />

                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                <Button Name="MakeCuttingButton"    Content="Раскроить"  Tag="access_mode_full_access" Style="{DynamicResource Button}" Click="MakeCuttingButton_Click" />
                                <CheckBox Name="CuttingWithPack" Content="Р. листов с/уп"  Style="{DynamicResource CheckBoxTopPanel}" />
                                <CheckBox Name="CuttingWithLong" Content="Р. с 1 пр. резкой"  Style="{DynamicResource CheckBoxTopPanel}" />
                                <CheckBox Name="Virtual" Content="Виртуальное сырье"  Style="{DynamicResource CheckBoxTopPanel}" Visibility="Hidden"  />
                                <CheckBox Name="TrimMatrix" Content="Обрезь, алгоритм 2" ToolTip="Расчет минимальной обрези по новому алгоритму" Style="{DynamicResource CheckBoxTopPanel}" Visibility="Hidden" />

                            </StackPanel>

                            <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,5,0,0" Style="{DynamicResource FormHeaderButtonsPanel}" HorizontalAlignment="Left"  >

                                <Label Content="По:"  Style="{DynamicResource TopLabel}" Width="25" />
                                <Grid Style="{DynamicResource FormFieldDateHolder}">
                                    <!--<TextBox Name="ToDate"  MaxLength="10"   Style="{DynamicResource FormFieldDate}" IsReadOnly="True"  />
                                    <DatePicker  SelectedDate="{Binding Path=Text, Mode=OneWayToSource, ElementName=ToDate, Converter={StaticResource DateDate} }"  Style="{DynamicResource FormFieldDP}" />-->
                                    <controls:DatePicker x:Name="ToDate" Style="{DynamicResource DateEditStyle}">
                                    </controls:DatePicker>
                                </Grid>

                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                <Label Content=""  Style="{DynamicResource TopLabel}" Width="38" />

                                <Label Content="Отклонение:"  Style="{DynamicResource TopLabel}"/>
                                <xctk:DecimalUpDown x:Name="Deviation" Width="45" Increment=".1" FormatString="F1" Margin="0,0,5,0" Maximum="100" Minimum="0" />

                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                <CheckBox Content="Выделить все"     Name="PositionSelectAll" Style="{DynamicResource CheckBoxTopPanel}" Click="PositionSelectAll_Click" />

                                <Label Content="Тип:" Style="{DynamicResource TopLabel}" />
                                <controls:SelectBox  x:Name="Type" SelectedItemChanged="Type_OnSelectedItemChanged" Style="{DynamicResource CustomFormField}" ListBoxMinWidth="150" ListBoxMinHeight="230" Width="140" Autocomplete="False" />
                                <Border Style="{DynamicResource FormButtonsPanelDoubleSpacer}"></Border>

                                <CheckBox Content="Несамокройные"    Name="Filter5" Style="{DynamicResource CheckBoxTopPanel}" Click="Filter5_Click" />

                                <CheckBox Content="Первое производство" ToolTip="Изделия, ни разу не отгружавшиеся" Click="ApplicationFilterFirst_Click"  Name="ApplicationFilterFirst" Style="{DynamicResource CheckBoxTopPanel}"  />

                                <CheckBox Content="Z-картон"    Name="FanfoldFilter" Style="{DynamicResource CheckBoxTopPanel}" Click="FanfoldFilter_Click" />

                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                <Label Content=""  Style="{DynamicResource TopLabel}" Width="8" />

                                <Label Content="Профиль:" Style="{DynamicResource TopLabel}" />
                                <controls:SelectBox x:Name="ProfileTypes" SelectedItemChanged="ProfileTypes_SelectedItemChanged"  Style="{DynamicResource CustomFormField}" ListBoxMinHeight="250" ListBoxMinWidth="120" Width="50" Autocomplete="True"   VerticalAlignment="Bottom" />
                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                <Label Content="Картон:" Style="{DynamicResource TopLabel}" />
                                <controls:SelectBox x:Name="Cardboard" SelectedItemChanged="Cardboard_SelectedItemChanged"  Style="{DynamicResource CustomFormField}" ListBoxMinWidth="200" ListBoxMinHeight="255"  Width="100" Autocomplete="True"   VerticalAlignment="Bottom" />
                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                <Label Content="ГА:" Style="{DynamicResource TopLabel}" />
                                <controls:SelectBox x:Name="CorrugatorSet" SelectedItemChanged="CorrugatorSet_SelectedItemChanged"  Style="{DynamicResource CustomFormField}" ListBoxMinWidth="200" ListBoxMinHeight="255"  Width="100" Autocomplete="True"   VerticalAlignment="Bottom" />
                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                <Button Name="PositionPrintButton" Click="PositionPrintButton_Click" Content="Печать"   Style="{DynamicResource Button}"     />


                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                <Label Content="Поиск:"  Style="{DynamicResource TopLabel}" />
                                <TextBox Name="PositionSearchText" Style="{DynamicResource FormFieldTopPanel}" Width="80" TextWrapping="NoWrap" />

                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>
                                <Button Name="LoadWaste" ToolTip="Загрузить отходы в Автораскрой" Content="Загрузить отходы" Tag="access_mode_full_access" Style="{DynamicResource Button}" Click="LoadWaste_Click" />
                            </StackPanel>

                        </Grid>

                        <StackPanel Grid.Row="0" Grid.Column="1" Style="{DynamicResource FormHeaderButtonsPanel}"  HorizontalAlignment="Right" VerticalAlignment="Top">
                            <Button Name="SettingsButton"    ToolTip="Настройка"   Style="{DynamicResource ButtonGlyph}" Click="SettingsButton_Click" >
                                <Image Style="{DynamicResource SettingsImage}" />
                            </Button>
                            <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>
                            <Button Name="HelpButton" ToolTip="Документация" Width="24" MinWidth="24"  Content="?"  Style="{DynamicResource Button}" Click="HelpButton_Click" Margin="0,0,0,0" />
                        </StackPanel>

                    </Grid>
                </Border>
            </Grid>

            <Grid Grid.Row="1"  Grid.Column="0" Grid.ColumnSpan="3" Panel.ZIndex="8">
                <Border Style="{DynamicResource DataGridMainHolder}" >
                    <controls:GridBox x:Name="PositionGrid" />
                </Border>
            </Grid>

            <Grid Grid.Row="2"  Grid.Column="0" Grid.ColumnSpan="3" Name="Position2GridToolbar" Panel.ZIndex="8">
                <Border Style="{DynamicResource DataGridMainHolder}" Height="24" Margin="0,5,0,0">
                    <StackPanel Orientation="Horizontal" Style="{DynamicResource TotalsBarContainer}" HorizontalAlignment="Left">
                        <Label Content="Количество дней докроя:" Style="{DynamicResource TopLabel}" />
                        <controls:SelectBox x:Name="AddDays" SelectedItemChanged="ProfileTypes_SelectedItemChanged"  Style="{DynamicResource CustomFormField}" ListBoxMinHeight="250" ListBoxMinWidth="120" Width="50" Autocomplete="True"   VerticalAlignment="Bottom" />

                        <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                        <CheckBox Content="Выделить все"  Name="Position2SelectAll" Style="{DynamicResource CheckBoxTopPanel}" Click="Position2SelectAll_Click" />

                        <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                        <Button Content="Печать" Name="Position2PrintButton" Click="Position2PrintButton_Click" Style="{DynamicResource Button}"     />

                        <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                        <Label Content="Поиск:"  Style="{DynamicResource TopLabel}" />
                        <TextBox Name="Position2SearchText" Style="{DynamicResource FormFieldTopPanel}" Width="80" TextWrapping="NoWrap" />
                        <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                        <Label Content="Картон:" Style="{DynamicResource TopLabel}" />
                        <controls:SelectBox x:Name="Cardboard2" SelectedItemChanged="Cardboard2_SelectedItemChanged"  Style="{DynamicResource CustomFormField}" ListBoxMinWidth="200" ListBoxMinHeight="255"  Width="100" Autocomplete="True"   VerticalAlignment="Bottom" />

                    </StackPanel>
                </Border>
            </Grid>

            <Grid Grid.Row="3"  Grid.Column="0" Grid.ColumnSpan="3" Panel.ZIndex="8">
                <Border Style="{DynamicResource DataGridMainHolder}" Margin="0,5,0,0" >
                    <controls:GridBox x:Name="Position2Grid" />
                </Border>
            </Grid>


            <Grid Grid.Row="0" Grid.Column="0" Grid.RowSpan="4" Name="PositionGridSplash" Visibility="Collapsed" Panel.ZIndex="10">
                <Border Background="#99ffffff">
                    <Border Margin="0,23,0,0" HorizontalAlignment="Center" VerticalAlignment="Top" BorderThickness="1" BorderBrush="#ffdedede" Width="350" Height="100" Background="#ffffffff">
                        <StackPanel Orientation="Vertical" >
                            <TextBlock HorizontalAlignment="Center" Margin="0,25,0,0" Foreground="#ff000000">Загрузка</TextBlock>
                            <ProgressBar Name="PositionGridSplashProgress" IsIndeterminate="True"  Minimum="0" Maximum="30" Value="0" Width="200" Height="15" Foreground="#ff0C79CA" Margin="0,10,0,0" />
                        </StackPanel>
                    </Border>
                </Border>
            </Grid>

            <Grid Grid.Row="4"  Grid.Column="0" Grid.ColumnSpan="3" Margin="0,5,0,0" VerticalAlignment="Stretch">

                <TabControl BorderThickness="0,1,0,0" Margin="0" Padding="0">

                    <TabItem Header="Задания" Name="TaskTab" Style="{DynamicResource TabItemStyle}">
                        <Border Style="{DynamicResource DataGridMainHolder}" >

                            <Grid Style="{DynamicResource DataGridContainer}" Margin="0">

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>

                                <Grid Grid.Row="0"  Grid.Column="0" Style="{DynamicResource GridControlPanel}">
                                    <Border Name="TaskGridToolbar" >
                                        <Grid >

                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="11*"/>
                                                <ColumnDefinition Width="0.3*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"></RowDefinition>
                                            </Grid.RowDefinitions>

                                            <StackPanel Grid.Row="0" Grid.Column="0"  Style="{DynamicResource FormHeaderButtonsPanel}" HorizontalAlignment="Left" >

                                                <Button Name="DeleteButton" Tag="access_mode_full_access"   Content="Удалить" ToolTip="Удалить выбранную строку" Style="{DynamicResource Button}" Click="DeleteButton_Click"  />

                                                <Button Name="RefreshButton"  Visibility="Collapsed"  Content="Обновить" Style="{DynamicResource Button}" Click="RefreshButton_Click" />

                                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                                <Button Name="SaveTasksButton" Content="Сохранить ПЗ" Tag="access_mode_full_access" ToolTip="Сохранить все ПЗ из списка"  Style="{DynamicResource Button}" Click="SaveTasksButton_Click" />

                                                <Border Style="{DynamicResource FormButtonsPanelDoubleSpacer}"></Border>

                                                <Button Content="В Excel"  Name="TaskExportButton" Click="TaskExportButton_Click" Style="{DynamicResource Button}" />

                                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                                <Button Content="Итоги"  Name="FormatLengthButton" Click="FormatLengthButton_Click" Style="{DynamicResource Button}" />

                                                <Border Style="{DynamicResource FormButtonsPanelDoubleSpacer}"></Border>

                                                <Label Content="Поиск:"  Style="{DynamicResource TopLabel}" />
                                                <TextBox Style="{DynamicResource FormFieldTopPanel}" Width="100" TextWrapping="NoWrap" Name="TaskSearchText"   />

                                                <Label MinWidth="150" Name="TaskTotals"  Style="{DynamicResource TopLabel}"/>

                                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>
                                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                                <Button Name="ToggleSplash31Button" Content="S1" Style="{DynamicResource Button}" MinWidth="24" Click="ToggleSplash31Button_Click" />
                                                <Button Name="ToggleSplash30Button" Content="S0" Style="{DynamicResource Button}" MinWidth="24" Click="ToggleSplash30Button_Click" />

                                            </StackPanel>

                                        </Grid>
                                    </Border>
                                </Grid>

                                <Grid Grid.Row="1"  Grid.Column="0" Panel.ZIndex="8">
                                    <Border Style="{DynamicResource DataGridMainHolder}" >
                                        <controls:GridBox x:Name="TaskGrid" />
                                    </Border>
                                </Grid>

                                <Grid Grid.Row="1" Grid.Column="0" Name="TaskGridSplash" Visibility="Collapsed" Panel.ZIndex="10">
                                    <Border Background="#99ffffff">
                                        <Border Margin="0,23,0,0" HorizontalAlignment="Center" VerticalAlignment="Top" BorderThickness="1" BorderBrush="#ffdedede" Width="350" Height="100" Background="#ffffffff">
                                            <StackPanel Orientation="Vertical" >
                                                <TextBlock HorizontalAlignment="Center" Margin="0,25,0,0" Foreground="#ff000000">Сохранение данных</TextBlock>
                                                <ProgressBar Name="TaskGridSplashProgress" Minimum="0" Maximum="30" Value="0" Width="200" Height="15" Foreground="#ff0C79CA" Margin="0,10,0,0" />
                                            </StackPanel>
                                        </Border>
                                    </Border>
                                </Grid>

                            </Grid>


                        </Border>
                    </TabItem>

                    <TabItem Header="Бумага" Name="PaperTab" Style="{DynamicResource TabItemStyle}">
                        <Border Style="{DynamicResource DataGridMainHolder}" >

                            <Grid Style="{DynamicResource DataGridContainer}">

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>

                                <Grid Grid.Row="0"  Grid.Column="0" Style="{DynamicResource GridControlPanel}">
                                    <Border Name="PaperGridToolbar" >
                                        <Grid >

                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="11*"/>
                                                <ColumnDefinition Width="0.3*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"></RowDefinition>
                                            </Grid.RowDefinitions>

                                            <StackPanel Grid.Row="0" Grid.Column="0" Style="{DynamicResource FormHeaderButtonsPanel}" HorizontalAlignment="Left" >
                                                <Button Name="PaperGridRefreshButton"  Visibility="Visible"  Content="Обновить" Style="{DynamicResource Button}" Click="PaperGridRefreshButton_Click" />
                                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                                <Label Content="Формат:" Style="{DynamicResource TopLabel}" />
                                                <controls:SelectBox x:Name="PaperFormat" Style="{DynamicResource CustomFormField}" Width="100" SelectedItemChanged="PaperFormat_SelectedItemChanged"/>
                                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>
                                                <Label Content="Плотность:" Style="{DynamicResource TopLabel}" />
                                                <controls:SelectBox x:Name="PaperDensity" Style="{DynamicResource CustomFormField}" Width="100" SelectedItemChanged="PaperDensity_SelectedItemChanged"/>
                                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                                <CheckBox Content="Только в наличии" Name="AvailableOnly"  Click="AvailableOnly_Click"   Style="{DynamicResource CheckBoxTopPanel}" />
                                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                                <Button Name="VirtualSourceButton"  Visibility="Visible" Tag="access_mode_full_access" Content="Виртуальное сырье" Style="{DynamicResource Button}" Click="VirtualSourceButton_Click" />
                                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                                <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>
                                                <Button Name="SourceToExcelButton" Content="В Excel" Style="{DynamicResource Button}" Click="SourceToExcel_Click" />
                                            </StackPanel>

                                        </Grid>
                                    </Border>
                                </Grid>

                                <Grid Grid.Row="1"  Grid.Column="0">
                                    <Border Style="{DynamicResource DataGridMainHolder}" >
                                        <controls:GridBox x:Name="PaperGrid" />
                                    </Border>
                                </Grid>

                            </Grid>

                        </Border>
                    </TabItem>

                    <TabItem Header="Итоги" Name="TotalTab" Style="{DynamicResource TabItemStyle}">
                        <Border Style="{DynamicResource DataGridMainHolder}">
                            <Grid Style="{DynamicResource DataGridContainer}">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"></RowDefinition>
                                    <RowDefinition Height="*"></RowDefinition>
                                </Grid.RowDefinitions>

                                <Grid Grid.Row="0"  Grid.Column="0" Style="{DynamicResource GridControlPanel}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="93*"/>
                                        <ColumnDefinition Width="1807*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Name="TotalGridToolbar" Style="{DynamicResource FormHeaderButtonsPanel}" HorizontalAlignment="Left" Grid.ColumnSpan="2">
                                        <Button Name="TotalGridRefreshButton"  Visibility="Visible"  Content="Обновить" Style="{DynamicResource Button}" Click="TotalGridRefreshButton_Click" />
                                        <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>

                                        <Label Content="Профиль:" Style="{DynamicResource TopLabel}" />
                                        <controls:SelectBox x:Name="ProfileTotals" SelectedItemChanged="ProfileTotals_SelectedItemChanged"  Style="{DynamicResource CustomFormField}" ListBoxMinHeight="250" ListBoxMinWidth="120" Width="90" Autocomplete="True"   VerticalAlignment="Bottom" />

                                        <Border Style="{DynamicResource FormButtonsPanelSpacer}"></Border>
                                        <Button Name="TotalToExcelButton" Content="В Excel" Style="{DynamicResource Button}" Click="TotalToExcel_Click" />
                                    </StackPanel>
                                </Grid>

                                <Grid Grid.Row="1"  Grid.Column="0">
                                    <Border Style="{DynamicResource DataGridMainHolder}" >
                                        <controls:GridBox x:Name="TotalGrid" />
                                    </Border>
                                </Grid>
                            </Grid>
                        </Border>
                    </TabItem>

                    <TabItem Header="Отладка" Name="DebugTab" Style="{DynamicResource TabItemStyle}">
                        <TextBox Name="DebugLog"  HorizontalAlignment="Stretch" Foreground="#ff555555" FontFamily="consolas" VerticalAlignment="Stretch"  FontSize="11" VerticalScrollBarVisibility="Visible" HorizontalScrollBarVisibility="Visible" TextWrapping="Wrap" />
                    </TabItem>

                </TabControl>


            </Grid>







        </Grid>
    </Border>

</UserControl>
