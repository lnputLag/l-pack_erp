<FlowDocument xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
              xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
              xmlns:xrd="clr-namespace:CodeReason.Reports.Document;assembly=CodeReason.Reports"
              xmlns:xrbc="clr-namespace:CodeReason.Reports.Document.Barcode;assembly=CodeReason.Reports"
             PageWidth="29.7cm"  PageHeight="21cm"  ColumnWidth="29.7cm" FontFamily="Verdana" FontSize="11" >
    <FlowDocument.Resources>
        
        <ResourceDictionary>

            <Style x:Key="paragraphStyle" TargetType="{x:Type Paragraph}">
                <Setter Property="TextAlignment" Value="Left"/>
            </Style>

            <Style x:Key="tableStyle" TargetType="{x:Type Table}">
                <Setter Property="Margin" Value="0cm,0cm,0cm,0cm"/>
            </Style>

            <Style x:Key="headerFooterRowStyle" TargetType="{x:Type TableRowGroup}">

            </Style>

            <Style x:Key="dataRowStyle" TargetType="{x:Type TableRowGroup}">
            </Style>

            <Style TargetType="{x:Type TableCell}">
                <Setter Property="Padding" Value="0.0cm,0.01cm,0.0cm,0.01cm"/>
                <Setter Property="BorderBrush" Value="Black"/>
                <Setter Property="BorderThickness" Value="0.02cm"/>
                <Setter Property="TextAlignment" Value="Left"/>
            </Style>

            <Style TargetType="{x:Type xrd:TableCellStyled}">
                <Setter Property="Padding" Value="0.0cm,0.01cm,0.0cm,0.01cm"/>
                <Setter Property="BorderBrush" Value="Black"/>
                <Setter Property="BorderThickness" Value="0.02cm"/>
                <Setter Property="TextAlignment" Value="Left"/>
            </Style>

            <Style x:Key="HeaderTable" TargetType="{x:Type Table}">
                <Setter Property="Padding" Value="0.0cm,0.01cm,0.0cm,0.01cm"/>
                <Setter Property="BorderBrush" Value="Black"/>
                <Setter Property="BorderThickness" Value="0.02cm"/>
                <Setter Property="TextAlignment" Value="Left"/>
            </Style>

            <Style x:Key="HeaderTableCell" TargetType="{x:Type TableCell}">
                <Setter Property="Padding" Value="0.0cm,0.01cm,0.0cm,0.01cm"/>
                <Setter Property="BorderBrush" Value="Black"/>
                <Setter Property="BorderThickness" Value="0.02cm"/>
                <Setter Property="TextAlignment" Value="Left"/>
            </Style>

            <Style x:Key="TableCellGreen" TargetType="{x:Type TableCell}">
                <Setter Property="Padding" Value="0.0cm,0.01cm,0.0cm,0.01cm"/>
                <Setter Property="BorderBrush" Value="Black"/>
                <Setter Property="BorderThickness" Value="0.02cm"/>
                <Setter Property="TextAlignment" Value="Left"/>
                <Setter Property="Background" Value="#FFC5FBC5"/>
            </Style>

            <Style x:Key="TableCellRed" TargetType="{x:Type TableCell}">
                <Setter Property="Padding" Value="0.0cm,0.01cm,0.0cm,0.01cm"/>
                <Setter Property="BorderBrush" Value="Black"/>
                <Setter Property="BorderThickness" Value="0.02cm"/>
                <Setter Property="TextAlignment" Value="Left"/>
                <Setter Property="Background" Value="#FFFFA0A0"/>
            </Style>

        </ResourceDictionary>      

    </FlowDocument.Resources>

    <xrd:ReportProperties >
        <xrd:ReportProperties.ReportName>ReportList</xrd:ReportProperties.ReportName>
        <xrd:ReportProperties.ReportTitle>Отчет по отгрузкам</xrd:ReportProperties.ReportTitle>
    </xrd:ReportProperties>

    <xrd:SectionReportHeader PageHeaderHeight="9" Padding="15,15,15,0" FontFamily="Verdana" FontSize="12" Margin="0,0,0,0" >
        
        <Table CellSpacing="0" Margin="0,0,0,10" >
            <Table.Columns>
                <TableColumn Width="1*" />
                <TableColumn Width="3*" />
                <TableColumn Width="1*" />
            </Table.Columns>
            <TableRowGroup>
                <TableRow>
                    <TableCell>
                        <Paragraph>
                            <xrd:InlineDocumentValue PropertyName="SystemName" /> (
                            <xrd:InlineContextValue PropertyName="ReportName" /> )
                        </Paragraph>
                    </TableCell>
                    <TableCell>
                        <Paragraph FontWeight="Bold" TextAlignment="Center">
                            <xrd:InlineContextValue PropertyName="ReportTitle" />
                            <xrd:InlineDocumentValue PropertyName="FromDate" Format="dd.MM.yyyy" /> -
                            <xrd:InlineDocumentValue PropertyName="ToDate" Format="dd.MM.yyyy" />
                        </Paragraph>
                    </TableCell>
                    <TableCell>
                        <Paragraph TextAlignment="Right">
                            <xrd:InlineDocumentValue PropertyName="Today" Format="dd.MM.yyyy HH:mm:ss" />
                        </Paragraph>
                    </TableCell>
                </TableRow>
            </TableRowGroup>
        </Table>

        <Table CellSpacing="0" Margin="0"  >
            <Table.Columns>

                <!-- # -->
                <TableColumn Width="1*" />
                <!-- Идент. -->
                <TableColumn Width="2*" />
                <!-- Покупатель -->
                <TableColumn Width="5*" />
                <!-- Водитель погрузчика -->
                <TableColumn Width="3*" />
                <!-- Само- вывоз -->
                <TableColumn Width="1.5*" />
                <!-- Упаковка -->
                <TableColumn Width="1.5*" />
                <!-- Дт/вр отгрузки -->
                <TableColumn Width="3*" />
                <!-- Дт/вр план. готовн. -->
                <TableColumn Width="3*" />
                <!-- Дт/вр ПЗ -->
                <TableColumn Width="3*" />
                <!-- Дт/вр водителя -->
                <TableColumn Width="3*" />
                <!-- Дт/вр терминал -->
                <TableColumn Width="3*" />
                <!-- Дт/вр факт. отгр. начало -->
                <TableColumn Width="3*" />
                <!-- Дт/вр факт. отгр. оконч. -->
                <TableColumn Width="3*" />
                <!-- Причина производство -->
                <TableColumn Width="5*" />
                <!-- Причина СГП -->
                <TableColumn Width="5*" />

            </Table.Columns>
            <TableRowGroup >

                <TableRow>
                    <TableCell RowSpan="2" Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            #
                        </Paragraph>
                    </TableCell>
                    <TableCell RowSpan="2" Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            Ид.
                        </Paragraph>
                    </TableCell>
                    <TableCell RowSpan="2" Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            Покупатель
                        </Paragraph>
                    </TableCell>
                    <TableCell RowSpan="2" Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            Водитель погр.
                        </Paragraph>
                    </TableCell>
                    <TableCell RowSpan="2" Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            Сам.
                        </Paragraph>
                    </TableCell>
                    <TableCell RowSpan="2" Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            Упак.
                        </Paragraph>
                    </TableCell>
                    <TableCell RowSpan="2" Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            Дт/вр отгрузки
                        </Paragraph>
                    </TableCell>
                    <TableCell RowSpan="2" Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            Дт/вр план. готовн.
                        </Paragraph>
                    </TableCell>
                    <TableCell RowSpan="2" Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            Дт/вр ПЗ
                        </Paragraph>
                    </TableCell>
                    <TableCell RowSpan="2" Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            Дт/вр водителя
                        </Paragraph>
                    </TableCell>
                    <TableCell RowSpan="2" Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            Дт/вр терминал
                        </Paragraph>
                    </TableCell>
                    <TableCell ColumnSpan="2" Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            Дт/вр факт. отгр.
                        </Paragraph>
                    </TableCell>
                    <TableCell ColumnSpan="2" Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            Причина производство
                        </Paragraph>
                    </TableCell>
                </TableRow>

                <TableRow>
                    <TableCell Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            начало
                        </Paragraph>
                    </TableCell>
                    <TableCell Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            оконч.
                        </Paragraph>
                    </TableCell >
                    <TableCell Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            производство
                        </Paragraph>
                    </TableCell>
                    <TableCell Style="{StaticResource HeaderTableCell}">
                        <Paragraph TextAlignment="Center">
                            СГП
                        </Paragraph>
                    </TableCell>
                </TableRow>

            </TableRowGroup>
        </Table>

    </xrd:SectionReportHeader>
    <xrd:SectionReportFooter PageFooterHeight="2" Padding="20,0,20,20" FontFamily="Verdana" FontSize="12" >
        <Table CellSpacing="0">
            <Table.Columns>
                <TableColumn Width="*" />
                <TableColumn Width="*" />
            </Table.Columns>
            <TableRowGroup>
                <TableRow>
                    <TableCell>
                        <Paragraph>

                        </Paragraph>
                    </TableCell>
                    <TableCell>

                    </TableCell>
                </TableRow>
            </TableRowGroup>
        </Table>
    </xrd:SectionReportFooter>

    <Section BreakPageBefore="True" Margin="2,0,2,0">       

        <Table CellSpacing="0" Margin="0" >
            <Table.Columns>                
                
                <!-- # -->
                <TableColumn Width="1*" />
                <!-- Идент. -->
                <TableColumn Width="2*" />
                <!-- Покупатель -->
                <TableColumn Width="5*" />
                <!-- Водитель погрузчика -->
                <TableColumn Width="3*" />
                <!-- Само- вывоз -->
                <TableColumn Width="1.5*" />
                <!-- Упаковка -->
                <TableColumn Width="1.5*" />
                <!-- Дт/вр отгрузки -->
                <TableColumn Width="3*" />                
                <!-- Дт/вр план. готовн. -->
                <TableColumn Width="3*" />
                <!-- Дт/вр ПЗ -->
                <TableColumn Width="3*" />
                <!-- Дт/вр водителя -->
                <TableColumn Width="3*" />
                <!-- Дт/вр терминал -->
                <TableColumn Width="3*" />
                <!-- Дт/вр факт. отгр. начало -->
                <TableColumn Width="3*" />
                <!-- Дт/вр факт. отгр. оконч. -->
                <TableColumn Width="3*" />
                <!-- Причина производство -->
                <TableColumn Width="5*" />
                <!-- Причина СГП -->
                <TableColumn Width="5*" />
                
            </Table.Columns>
            
            <TableRowGroup >
                <xrd:TableRowForDataTable TableName="Shipments">
                    <TableCell>
                        <Paragraph TextAlignment="Center">
                            <xrd:InlineTableCellValue PropertyName="RownNmber" />
                        </Paragraph>
                    </TableCell>
                    <xrd:TableCellStyled ColumnName="Id">
                        <Paragraph TextAlignment="Left">
                            <xrd:InlineTableCellValue PropertyName="Id" />
                        </Paragraph>
                    </xrd:TableCellStyled>
                    <xrd:TableCellStyled ColumnName="Buyer">
                        <Paragraph TextAlignment="Left" >
                            <xrd:InlineTableCellValue PropertyName="Buyer" />
                        </Paragraph>
                    </xrd:TableCellStyled>
                    <TableCell>
                        <Paragraph TextAlignment="Left">
                            <xrd:InlineTableCellValue PropertyName="ForkliftDriver" />
                        </Paragraph>
                    </TableCell>
                    <TableCell>
                        <Paragraph TextAlignment="Center">
                            <xrd:InlineTableCellValue PropertyName="SelfShipment" />
                        </Paragraph>
                    </TableCell>
                    <TableCell>
                        <Paragraph TextAlignment="Center">
                            <xrd:InlineTableCellValue PropertyName="Packaging" />
                        </Paragraph>
                    </TableCell>
                    <TableCell>
                        <Paragraph TextAlignment="Left">
                            <xrd:InlineTableCellValue PropertyName="ShipmentDate" />
                        </Paragraph>
                    </TableCell>
                    <TableCell>
                        <Paragraph TextAlignment="Left">
                            <xrd:InlineTableCellValue PropertyName="CompleteDate" />
                        </Paragraph>
                    </TableCell>
                    <xrd:TableCellStyled ColumnName="ProductionTaskDate">
                        <Paragraph TextAlignment="Left">
                            <xrd:InlineTableCellValue PropertyName="ProductionTaskDate" />
                        </Paragraph>
                    </xrd:TableCellStyled>
                    <xrd:TableCellStyled ColumnName="DriverEntranceDate">
                        <Paragraph TextAlignment="Left">
                            <xrd:InlineTableCellValue PropertyName="DriverEntranceDate" />
                        </Paragraph>
                    </xrd:TableCellStyled>
                    <xrd:TableCellStyled ColumnName="ShipmentBindingDate">
                        <Paragraph TextAlignment="Left">
                            <xrd:InlineTableCellValue PropertyName="ShipmentBindingDate" />
                        </Paragraph>
                    </xrd:TableCellStyled>
                    <TableCell>
                        <Paragraph TextAlignment="Left">
                            <xrd:InlineTableCellValue PropertyName="ShipmentStartDate" />
                        </Paragraph>
                    </TableCell>
                    <TableCell>
                        <Paragraph TextAlignment="Left">
                            <xrd:InlineTableCellValue PropertyName="ShipmentFinishDate" />
                        </Paragraph>
                    </TableCell>
                    <TableCell>
                        <Paragraph TextAlignment="Left">
                            <xrd:InlineTableCellValue PropertyName="ReasonMaster" />
                        </Paragraph>
                    </TableCell>
                    <TableCell>
                        <Paragraph TextAlignment="Left">
                            <xrd:InlineTableCellValue PropertyName="ReasonStock" />
                        </Paragraph>
                    </TableCell>

                </xrd:TableRowForDataTable>
            </TableRowGroup>

        </Table>

    </Section>

</FlowDocument>


