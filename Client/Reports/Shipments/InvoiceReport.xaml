<FlowDocument xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
              xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
              xmlns:xrd="clr-namespace:CodeReason.Reports.Document;assembly=CodeReason.Reports"
              xmlns:xrbc="clr-namespace:CodeReason.Reports.Document.Barcode;assembly=CodeReason.Reports"
              PageHeight="29.7cm" PageWidth="21cm" ColumnWidth="21cm" FontFamily="Verdana" FontSize="14" >
    <FlowDocument.Resources>


        <Style x:Key="paragraphStyle" TargetType="{x:Type Paragraph}">
            <Setter Property="TextAlignment" Value="Left"/>
        </Style>

        <Style x:Key="tableStyle" TargetType="{x:Type Table}">
            <Setter Property="Margin" Value="0cm,0cm,0cm,0cm"/>
        </Style>


        <Style x:Key="headerFooterRowStyle" TargetType="{x:Type TableRowGroup}">
        </Style>

        <Style x:Key="dataRowStyle" TargetType="{x:Type TableRowGroup}">
        </Style>

        <Style x:Key="HiddenBorder" TargetType="{x:Type TableCell}">
            <Setter Property="Padding" Value="0.0cm,0.01cm,0.0cm,0.01cm"/>
            <Setter Property="BorderBrush" Value="Black"/>
            <Setter Property="BorderThickness" Value="0.02cm"/>
            <Setter Property="TextAlignment" Value="Left"/>
        </Style>


        <Style TargetType="{x:Type TableCell}">
            <Setter Property="Padding" Value="0.0cm,0.01cm,0.0cm,0.01cm"/>
            <Setter Property="BorderBrush" Value="Black"/>
            <Setter Property="BorderThickness" Value="0.00cm"/>
            <Setter Property="TextAlignment" Value="Left"/>
        </Style>

    </FlowDocument.Resources>




    <!--

    <xrd:SectionReportHeader PageHeaderHeight="2" Padding="15,20,15,0" FontFamily="Verdana" FontSize="12">
        <Table CellSpacing="0">
            <Table.Columns>
                <TableColumn Width="*" />
                <TableColumn Width="*" />
            </Table.Columns>
            <TableRowGroup>
                <TableRow>
                    <TableCell>
                        <Paragraph>
                            <xrd:InlineDocumentValue PropertyName="SystemName" /> (
                            <xrd:InlineContextValue PropertyName="ReportName" /> )
                        </Paragraph>
                    </TableCell>
                    <TableCell>
                        <Paragraph TextAlignment="Right">
                            <xrd:InlineDocumentValue PropertyName="Today" Format="dd.MM.yyyy HH:mm:ss" />
                        </Paragraph>
                    </TableCell>
                </TableRow>
            </TableRowGroup>
        </Table>
    </xrd:SectionReportHeader>
-->
    <!--
    <xrd:ReportProperties >
        <xrd:ReportProperties.ReportName>InvoiceReport</xrd:ReportProperties.ReportName>
        <xrd:ReportProperties.ReportTitle>Расходная накладная № [NUM] от [DT] г.</xrd:ReportProperties.ReportTitle>
    </xrd:ReportProperties>

    -->


    <Section BreakPageBefore="True" Margin="2,0,2,0">


        <Paragraph TextAlignment="Left" >
            <!--
            <xrbc:InlineBarcodeC128 PropertyName="Code128" Width="6cm" Height="2cm" BarcodeSubType="A"/>
            <xrbc:InlineBarcodeC128 PropertyName="Code128" Width="6cm" Height="2cm" BarcodeSubType="B"/>
            -->
            <xrbc:InlineBarcodeC128 PropertyName="Code128" Width="6cm" Height="1.0cm" BarcodeSubType="C" HorizontalAlignment="Left"/>
            <!--
            <xrbc:InlineBarcodeC128 PropertyName="Code128" Width="5cm" Height="1cm" BarcodeSubType="BC"/>
            -->
        </Paragraph>

        <Section Name="Map" Margin="0,0,0,0">
            <Table CellSpacing="0" >
                <Table.Columns>
                    <TableColumn Width="1*" />
                </Table.Columns>
                <TableRowGroup>
                    <TableRow>
                        <TableCell  BorderThickness="0,0,0,2">
                            <Paragraph FontWeight="Bold" TextAlignment="Left" FontSize="16">
                                Расходная накладная №
                                <xrd:InlineDocumentValue PropertyName="NUM"/> от
                                <xrd:InlineDocumentValue PropertyName="DT"/> г.
                            </Paragraph>
                        </TableCell>
                    </TableRow>
                </TableRowGroup>
            </Table>
        </Section>



        <Table CellSpacing="0"  FontSize="13">
            <Table.Columns>
                <TableColumn Width="10*" />
                <TableColumn Width="0.01*" />
                <TableColumn Width="50*" />
            </Table.Columns>
            <TableRowGroup>

                <TableRow>
                    <TableCell>
                        <Paragraph TextAlignment="Left">
                            Поставщик:
                        </Paragraph>
                    </TableCell>
                    <TableCell></TableCell>
                    <TableCell>
                        <Paragraph >
                            <xrd:InlineDocumentValue PropertyName="NAME_PROD"  FontWeight="Bold" />
                        </Paragraph>
                    </TableCell>
                </TableRow>

                <TableRow>
                    <TableCell>
                        <Paragraph TextAlignment="Left">
                            Покупатель:
                        </Paragraph>
                    </TableCell>
                    <TableCell></TableCell>
                    <TableCell>
                        <Paragraph >
                            <xrd:InlineDocumentValue PropertyName="NAME_POK" FontWeight="Bold" />
                        </Paragraph>
                    </TableCell>
                </TableRow>


            </TableRowGroup>
        </Table>

        <Paragraph FontWeight="Bold" TextAlignment="Center">
        </Paragraph>



        <Table CellSpacing="0"  FontSize="11" >
            <Table.Columns>
                <TableColumn Width="1*" />
                <TableColumn Width="16*" />
                <TableColumn Width="3*" />
                <TableColumn Width="3*" />
                <TableColumn Width="3*" />
            </Table.Columns>
            <TableRowGroup>
                <TableRow>
                    <TableCell BorderThickness="0.02cm">
                        <Paragraph TextAlignment="Center" FontWeight="Bold">
                            №
                        </Paragraph>
                    </TableCell>
                    <TableCell BorderThickness="0.02cm">
                        <Paragraph TextAlignment="Center" FontWeight="Bold">
                            Товар
                        </Paragraph>
                    </TableCell>
                    <TableCell BorderThickness="0.02cm">
                        <Paragraph TextAlignment="Center" FontWeight="Bold">
                            Количество
                        </Paragraph>
                    </TableCell>
                    <TableCell BorderThickness="0.02cm">
                        <Paragraph TextAlignment="Center" FontWeight="Bold">
                            Цена
                        </Paragraph>
                    </TableCell>
                    <TableCell BorderThickness="0.02cm" FontWeight="Bold">
                        <Paragraph TextAlignment="Center">Сумма</Paragraph>
                    </TableCell>
                </TableRow>
            </TableRowGroup>

            <TableRowGroup>
                <xrd:TableRowForDataTable TableName="Positions">
                    <TableCell BorderThickness="0.02cm">
                        <Paragraph TextAlignment="Right" Padding="2,2,2,2">
                            <xrd:InlineTableCellValue PropertyName="Number" />
                        </Paragraph>
                    </TableCell>
                    <TableCell BorderThickness="0.02cm">
                        <Paragraph TextAlignment="Left" Padding="2,2,2,2">
                            <xrd:InlineTableCellValue PropertyName="Name" />
                        </Paragraph>
                    </TableCell>
                    <TableCell BorderThickness="0.02cm">
                        <Paragraph TextAlignment="Right" Padding="2,2,2,2">
                            <xrd:InlineTableCellValue PropertyName="Qty" />
                        </Paragraph>
                    </TableCell>
                    <TableCell BorderThickness="0.02cm">
                        <Paragraph TextAlignment="Right" Padding="2,2,2,2">
                            <xrd:InlineTableCellValue PropertyName="Price" />
                        </Paragraph>
                    </TableCell>
                    <TableCell BorderThickness="0.02cm">
                        <Paragraph TextAlignment="Right">
                            <xrd:InlineTableCellValue PropertyName="Sum" />
                        </Paragraph>
                    </TableCell>
                </xrd:TableRowForDataTable>
            </TableRowGroup>

        </Table>




        <Table CellSpacing="0" FontSize="11">
            <Table.Columns>
                <TableColumn Width="10*" />
                <TableColumn Width="0.1*" />
                <TableColumn Width="1*" />
            </Table.Columns>
            <TableRowGroup>

                <TableRow>
                    <TableCell>
                        <Paragraph TextAlignment="Right"  FontWeight="Bold">
                            Итого:
                        </Paragraph>
                    </TableCell>
                    <TableCell></TableCell>
                    <TableCell>
                        <Paragraph FontWeight="Bold">
                            <xrd:InlineDocumentValue PropertyName="SumS"  />
                        </Paragraph>
                    </TableCell>
                </TableRow>

                <TableRow>
                    <TableCell>
                        <Paragraph TextAlignment="Right"  FontWeight="Bold">
                            В том числе НДС:
                        </Paragraph>
                    </TableCell>
                    <TableCell></TableCell>
                    <TableCell>
                        <Paragraph FontWeight="Bold">
                            <xrd:InlineDocumentValue PropertyName="TotalVAT"  />
                        </Paragraph>
                    </TableCell>
                </TableRow>

            </TableRowGroup>
        </Table>



        <Paragraph TextAlignment="Left" FontSize="10">
            Всего наименований
            <xrd:InlineDocumentValue PropertyName="AllLines"  /> , на сумму
            <xrd:InlineDocumentValue PropertyName="SumX"/>
        </Paragraph>

        <Table CellSpacing="0" >
            <Table.Columns>
                <TableColumn Width="1*" />
                <TableColumn Width="0.1*" />
                <TableColumn Width="2*" />
            </Table.Columns>
            <TableRowGroup>

                <TableRow>
                    <TableCell BorderThickness="0,0,0,2">
                        <Paragraph TextAlignment="Left" FontSize="10" FontWeight="Bold" >
                            <xrd:InlineDocumentValue PropertyName="DIGITALTOSTRSumS"  />
                        </Paragraph>
                    </TableCell>
                </TableRow>
            </TableRowGroup>
        </Table>
        <!--
        <Paragraph TextAlignment="Left">
        </Paragraph>
-->
        <Table CellSpacing="0" FontSize="10" FontWeight="Bold">
            <Table.Columns>
                <TableColumn Width="5*" />
                <TableColumn Width="0.1*" />
                <TableColumn Width="5*" />
                <TableColumn Width="0.1*" />
            </Table.Columns>
            <TableRowGroup>

                <TableRow>
                    <TableCell>
                        <Paragraph TextAlignment="Left">
                            Отпустил __________________________
                        </Paragraph>
                    </TableCell>
                    <TableCell></TableCell>
                    <TableCell>
                        <Paragraph TextAlignment="Left">
                            Получил __________________________
                        </Paragraph>
                    </TableCell>
                    <TableCell></TableCell>
                </TableRow>
            </TableRowGroup>
        </Table>
    </Section>
</FlowDocument>


